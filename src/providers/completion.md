# Провайдер Автодополнения (`CompletionItemProvider`)

Этот класс отвечает за появление выпадающего списка с подсказками (IntelliSense) при написании кода в HTML-шаблонах. Он помогает пользователям быстро вставлять селекторы компонентов и директив.

## Принцип работы

`CompletionItemProvider` реализует стандартный интерфейс VS Code `CompletionItemProvider`.

1.  **Активация**: VS Code вызывает метод `provideCompletionItems` этого класса, когда пользователь начинает печатать в HTML-файле. Провайдер зарегистрирован для срабатывания на определенные символы-триггеры, такие как `<` (начало тега).
2.  **Анализ контекста**: Провайдер анализирует текст вокруг курсора, чтобы понять, что именно сейчас пишет пользователь.
    -   Если пользователь напечатал `<` и начинает вводить имя тега (например, `<my-`), провайдер извлекает этот префикс — `my-`.
3.  **Запрос к `AngularIndexer`**:
    -   С извлеченным префиксом он обращается к `AngularIndexer` и вызывает метод `searchWithSelectors(prefix)`.
    -   Этот метод, используя мощь префиксного дерева (`SelectorTrie`), мгновенно возвращает все селекторы, которые начинаются с данного префикса.
4.  **Создание `CompletionItem`**:
    -   Для каждого найденного селектора провайдер создает объект `vscode.CompletionItem`.
    -   Каждый `CompletionItem` содержит:
        -   `label`: Текст, который видит пользователь в списке (например, `my-component`).
        -   `kind`: Тип элемента (например, `vscode.CompletionItemKind.Class` для компонента).
        -   `detail`: Дополнительная информация (например, `from ./my.component`).
        -   `documentation`: Более подробное описание.
        -   `insertText`: Текст, который будет вставлен в редактор.
5.  **Возврат списка**: VS Code получает список этих `CompletionItem`'ов и отображает их пользователю в виде выпадающего меню.

## Отличие от QuickfixProvider

-   **Проактивность**: `CompletionProvider` работает **проактивно**, предлагая варианты по мере ввода, в то время как `QuickfixProvider` работает **реактивно**, предлагая исправления для уже существующих ошибок.
-   **Источник данных**: `CompletionProvider` почти исключительно полагается на метод `searchWithSelectors` индексатора, который использует префиксный поиск. `QuickfixProvider` в основном использует `getElement` для поиска по точному (или почти точному) совпадению. 