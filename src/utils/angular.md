# Утилиты для Angular (`angular.ts`)

Этот файл содержит набор ключевых вспомогательных функций, которые используются в разных частях расширения для работы с селекторами и другими сущностями Angular. Он вынесен в утилиты, чтобы избежать дублирования кода.

## Ключевые функции

### `parseAngularSelector(selectorString: string): string[]`

Это, возможно, **самая важная функция во всем расширении**, так как именно она обеспечивает "умный" поиск по частям селектора.

**Что она делает:**

1.  Принимает на вход полную строку селектора из декоратора, например, `'table[jupiter-table][bigRows], .some-class'`.
2.  **Разделяет по запятой**: Сначала она разделяет строку на отдельные селекторы: `'table[jupiter-table][bigRows]'` и `'.some-class'`.
3.  **Вызывает `normalizeSelector`**: Для каждого отдельного селектора она вызывает `normalizeSelector`.

### `normalizeSelector(selector: string): string[]`

Эта функция выполняет всю работу по деконструкции селектора.

**Что она делает:**

Берет один селектор (например, `'table[jupiter-table][bigRows]'`) и разбирает его на все возможные составные части, которые могут быть использованы для поиска.

-   Для селектора `'table[jupiter-table][bigRows]'` она вернет массив:
    ```
    [
      "table[jupiter-table][bigRows]", // Полный селектор
      "table",                       // Имя тега
      "[jupiter-table]",               // Атрибут в скобках
      "jupiter-table",               // Имя атрибута
      "[bigRows]",                     // Атрибут в скобках
      "bigRows"                        // Имя атрибута
    ]
    ```
-   Для селектора `'[myDirective]'` она вернет `['[myDirective]', 'myDirective']`.
-   Для селектора `'.my-class'` она вернет `['.my-class', 'my-class']`.

**Результат работы этих двух функций — это массив ключей, которые `AngularIndexer` затем добавляет в `SelectorTrie`.** Именно благодаря этой логике `QuickfixProvider` может найти директиву по одному лишь имени атрибута `bigRows`.

### `getAngularElement(selector: string, indexer: AngularIndexer)`

Это обертка над `indexer.getElement(selector)`. Она используется провайдерами, чтобы получить информацию об элементе. Основная ее задача — попробовать несколько вариантов поиска:
- Ищет селектор как есть.
- Генерирует и ищет простые варианты, например, для `*ngIf` она попробует найти `ngIf` и `[ngIf]`.
- Проверяет стандартные элементы Angular (такие как `ngIf`, `ngFor`) по встроенному списку. 